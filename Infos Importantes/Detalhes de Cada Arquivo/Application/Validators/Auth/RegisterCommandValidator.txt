=========================================================
REGISTERCOMMANDVALIDATOR.CS - DOCUMENTAÇÃO TÉCNICA
=========================================================

VISÃO GERAL:
-----------
Validator enterprise para comandos de registro com validações de segurança abrangentes.
Implementa validação robusta de dados de registro para sistemas multi-tenant.
Parte do sistema de autenticação e criação de contas da aplicação.

LOCALIZAÇÃO:
-----------
📁 AuthTenant.Application/Validators/Auth/RegisterCommandValidator.cs

DEPENDÊNCIAS:
------------
✅ FluentValidation - Framework de validação
✅ AuthTenant.Application.Commands.Auth.RegisterCommand - Comando de registro
✅ System.Text.RegularExpressions - Validações regex
✅ System.Globalization - Formatação de dados

RESPONSABILIDADES:
-----------------
🔸 Validação robusta de email único
🔸 Validação de complexidade de senha
🔸 Validação de nome completo
🔸 Validação de nome de usuário único
🔸 Validação de formato de tenant ID
🔸 Segurança contra ataques de injeção
🔸 Verificação de políticas de registro enterprise

VALIDAÇÕES IMPLEMENTADAS:
------------------------

1. EMAIL:
   ✅ Obrigatório e não nulo
   ✅ Formato de email válido (regex RFC 5322)
   ✅ Comprimento máximo de 254 caracteres
   ✅ Domínio de email válido
   ✅ Verificação contra lista de domínios proibidos
   ✅ Detecção de emails temporários/descartáveis
   ✅ Validação de caracteres especiais permitidos
   ✅ Prevenção de SQL injection em campos de email
   ✅ Verificação de unicidade (pode ser implementada)

2. SENHA:
   ✅ Obrigatória e não nula
   ✅ Comprimento mínimo de 8 caracteres
   ✅ Comprimento máximo de 128 caracteres
   ✅ Pelo menos uma letra maiúscula
   ✅ Pelo menos uma letra minúscula
   ✅ Pelo menos um número
   ✅ Pelo menos um caractere especial
   ✅ Sem espaços em branco
   ✅ Não pode ser uma senha comum/vulnerável
   ✅ Verificação contra padrões sequenciais

3. NOME COMPLETO:
   ✅ Obrigatório e não nulo
   ✅ Comprimento entre 2 e 100 caracteres
   ✅ Apenas letras, espaços e caracteres acentuados
   ✅ Não pode conter apenas espaços
   ✅ Pelo menos nome e sobrenome
   ✅ Não pode conter números ou símbolos
   ✅ Validação contra nomes inapropriados

4. NOME DE USUÁRIO:
   ✅ Obrigatório e não nulo
   ✅ Comprimento entre 3 e 30 caracteres
   ✅ Apenas letras, números e underscores
   ✅ Deve começar com letra
   ✅ Não pode terminar com underscore
   ✅ Sem underscores consecutivos
   ✅ Verificação contra nomes reservados
   ✅ Verificação de unicidade (pode ser implementada)

5. TENANT ID:
   ✅ Obrigatório quando fornecido
   ✅ Formato de GUID válido
   ✅ Não pode ser GUID vazio
   ✅ Validação de integridade do tenant

CONSTANTES DE VALIDAÇÃO:
-----------------------
📊 MAX_EMAIL_LENGTH = 254 caracteres
📊 MIN_PASSWORD_LENGTH = 8 caracteres
📊 MAX_PASSWORD_LENGTH = 128 caracteres
📊 MIN_NAME_LENGTH = 2 caracteres
📊 MAX_NAME_LENGTH = 100 caracteres
📊 MIN_USERNAME_LENGTH = 3 caracteres
📊 MAX_USERNAME_LENGTH = 30 caracteres
📊 EMAIL_PATTERN = Regex RFC 5322 compliant
📊 PASSWORD_PATTERN = Complexidade enterprise
📊 NAME_PATTERN = Apenas letras e espaços
📊 USERNAME_PATTERN = Alfanumérico com underscores

CÓDIGOS DE ERRO PERSONALIZADOS:
------------------------------
❌ REGISTER_EMAIL_REQUIRED - Email obrigatório
❌ REGISTER_EMAIL_FORMAT - Formato de email inválido
❌ REGISTER_EMAIL_LENGTH - Comprimento de email inválido
❌ REGISTER_EMAIL_DOMAIN - Domínio não permitido
❌ REGISTER_EMAIL_DISPOSABLE - Email temporário detectado
❌ REGISTER_PASSWORD_REQUIRED - Senha obrigatória
❌ REGISTER_PASSWORD_LENGTH - Comprimento de senha inválido
❌ REGISTER_PASSWORD_COMPLEXITY - Complexidade insuficiente
❌ REGISTER_PASSWORD_WHITESPACE - Espaços não permitidos
❌ REGISTER_PASSWORD_COMMON - Senha muito comum
❌ REGISTER_NAME_REQUIRED - Nome obrigatório
❌ REGISTER_NAME_LENGTH - Comprimento de nome inválido
❌ REGISTER_NAME_FORMAT - Formato de nome inválido
❌ REGISTER_NAME_STRUCTURE - Estrutura de nome incorreta
❌ REGISTER_USERNAME_REQUIRED - Username obrigatório
❌ REGISTER_USERNAME_LENGTH - Comprimento de username inválido
❌ REGISTER_USERNAME_FORMAT - Formato de username inválido
❌ REGISTER_USERNAME_START - Username deve começar com letra
❌ REGISTER_USERNAME_CONSECUTIVE - Underscores consecutivos
❌ REGISTER_USERNAME_RESERVED - Username reservado
❌ REGISTER_TENANT_REQUIRED - Tenant ID obrigatório
❌ REGISTER_TENANT_FORMAT - Formato de tenant inválido

MÉTODOS DE VALIDAÇÃO CUSTOMIZADOS:
---------------------------------

🔧 BeValidEmailFormat(string email)
   - Valida formato completo de email
   - Verifica sintaxe RFC 5322
   - Detecta caracteres especiais inválidos

🔧 BeValidEmailDomain(string email)
   - Valida domínio do email
   - Verifica DNS do domínio
   - Bloqueia domínios maliciosos conhecidos

🔧 NotBeDisposableEmail(string email)
   - Detecta emails temporários/descartáveis
   - Verifica contra lista de provedores temporários
   - Melhora segurança de registro

🔧 NotContainSqlInjection(string input)
   - Detecta tentativas de SQL injection
   - Verifica padrões maliciosos
   - Protege contra ataques de injeção

🔧 MeetPasswordComplexity(string password)
   - Verifica complexidade completa da senha
   - Valida regras enterprise de senha
   - Confirma presença de caracteres obrigatórios

🔧 NotBeCommonPassword(string password)
   - Verifica contra lista de senhas comuns
   - Detecta padrões sequenciais
   - Previne uso de senhas vulneráveis

🔧 NotContainOnlyWhitespace(string input)
   - Verifica se não contém apenas espaços
   - Valida conteúdo significativo
   - Previne campos vazios disfarçados

🔧 BeValidFullName(string name)
   - Valida estrutura de nome completo
   - Verifica presença de nome e sobrenome
   - Confirma formato apropriado

🔧 NotContainInappropriateWords(string name)
   - Verifica contra lista de palavras inadequadas
   - Bloqueia nomes ofensivos
   - Mantém qualidade da base de usuários

🔧 StartWithLetter(string username)
   - Confirma que username inicia com letra
   - Aplica regras de nomenclatura
   - Evita usernames confusos

🔧 NotEndWithUnderscore(string username)
   - Verifica terminação apropriada
   - Aplica regras de formatação
   - Melhora legibilidade

🔧 NotContainConsecutiveUnderscores(string username)
   - Detecta underscores consecutivos
   - Mantém padrão de qualidade
   - Evita usernames mal formatados

🔧 NotBeReservedUsername(string username)
   - Verifica contra lista de nomes reservados
   - Protege termos do sistema
   - Evita conflitos de nomenclatura

🔧 BeValidGuid(Guid? tenantId)
   - Valida formato de GUID
   - Verifica se não é GUID vazio
   - Confirma integridade do tenant

FUNCIONALIDADES DE SEGURANÇA:
-----------------------------
🔒 Prevenção de SQL Injection
🔒 Detecção de emails descartáveis
🔒 Validação de domínios DNS
🔒 Verificação de senhas comprometidas
🔒 Normalização de dados de entrada
🔒 Códigos de erro não informativos para atacantes
🔒 Validação de nomes apropriados
🔒 Proteção contra usernames reservados

CONFIGURAÇÃO INTERNACIONAL:
--------------------------
🌐 Suporte a mensagens em português (pt-BR)
🌐 Suporte a mensagens em inglês (en-US)
🌐 Configuração dinâmica de cultura
🌐 Formatação localizada de mensagens
🌐 Suporte a caracteres especiais de diferentes idiomas

PADRÕES ARQUITETURAIS:
---------------------
🏗️ Clean Architecture - Separação clara de responsabilidades
🏗️ DDD (Domain-Driven Design) - Validação de domínio
🏗️ SOLID Principles - Single Responsibility
🏗️ Fail-Fast - Validação em cascata
🏗️ Security by Design - Validações de segurança

INTEGRAÇÃO COM SISTEMA:
----------------------
🔗 MediatR Pipeline - Execução automática
🔗 AuthController - Validação de registro
🔗 Exception Middleware - Tratamento de erros
🔗 Logging Behavior - Auditoria de registros
🔗 UserService - Verificação de unicidade

CENÁRIOS DE TESTE RECOMENDADOS:
------------------------------
✅ Registro válido com dados completos
✅ Email já existente no sistema
✅ Email inválido (formato incorreto)
✅ Email com domínio inexistente
✅ Email descartável/temporário
✅ Senha muito simples
✅ Senha sem complexidade suficiente
✅ Nome com números ou símbolos
✅ Nome muito curto ou muito longo
✅ Username já existente
✅ Username com formato inválido
✅ Username reservado pelo sistema
✅ Tenant ID inválido ou vazio
✅ Tentativas de SQL injection
✅ Caracteres especiais maliciosos

PERFORMANCE:
-----------
⚡ Validação em cascata otimizada
⚡ Regex compilada para performance
⚡ Cache de domínios válidos
⚡ Verificação rápida de senhas comuns
⚡ Lookup eficiente de usernames reservados

MANUTENÇÃO:
----------
🔧 Lista de senhas comuns atualizável
🔧 Lista de domínios descartáveis expansível
🔧 Lista de usernames reservados configurável
🔧 Lista de palavras inapropriadas editável
🔧 Padrões de validação configuráveis
🔧 Códigos de erro personalizáveis

CONSIDERAÇÕES DE SEGURANÇA:
--------------------------
⚠️ Não logar senhas ou dados sensíveis
⚠️ Usar códigos de erro genéricos publicamente
⚠️ Atualizar listas de senhas comprometidas
⚠️ Monitorar tentativas de registro maliciosas
⚠️ Implementar rate limiting para registros
⚠️ Verificar unicidade de email/username no banco

EXEMPLO DE USO:
--------------
```csharp
var validator = new RegisterCommandValidator();
var command = new RegisterCommand(
    "user@domain.com", 
    "SecurePass123!", 
    "João Silva", 
    "joaosilva",
    tenantId
);
var result = validator.Validate(command);

if (!result.IsValid)
{
    // Processar erros de validação
    foreach (var error in result.Errors)
    {
        Console.WriteLine($"{error.ErrorCode}: {error.ErrorMessage}");
    }
}
```

VERSIONAMENTO:
-------------
📋 Versão: 2.0.0
📋 Última Atualização: 2024
📋 Compatibilidade: .NET 8+
📋 Status: Produção

AUTOR & RESPONSÁVEL:
-------------------
👨‍💻 Desenvolvido por: Equipe AuthTenant
👨‍💻 Mantido por: Time de Segurança
📧 Contato: security@AuthTenant.com

=========================================================
